import{_ as k,ad as r,c as u,o as h,b as l,k as e,aE as o,a5 as t,m as i,dS as A}from"./chunks/framework.BN_kmrHV.js";const B=JSON.parse('{"title":"è®°ä¸€æ¬¡ Canvas å†…å¼•ç”¨äº† OSS åŸŸçš„å›¾ç‰‡æ ‡ç­¾ç»˜åˆ¶æ—¶å‡ºç°çš„ CORS é”™è¯¯é—®é¢˜","description":"","frontmatter":{"tags":["å¼€å‘/å‰ç«¯","è®¡ç®—æœº/ç½‘ç»œ/è·¨åŸŸ","è®¡ç®—æœº/ç½‘ç»œ/è·¨åŸŸ/CORS","å¼€å‘/æ ‡è®°è¯­è¨€/HTML","å¼€å‘/æ ‡è®°è¯­è¨€/HTML/Canvas","åŸºç¡€è®¾æ–½/å­˜å‚¨/å¯¹è±¡å­˜å‚¨/é˜¿é‡Œäº‘/OSS","åŸºç¡€è®¾æ–½/äº‘æœåŠ¡å•†/é˜¿é‡Œäº‘/Aliyun"]},"headers":[],"relativePath":"zh-CN/ç¬”è®°/ğŸ› ï¸ å¼€å‘/è®°ä¸€æ¬¡ Canvas å†…å¼•ç”¨äº† OSS åŸŸçš„å›¾ç‰‡æ ‡ç­¾ç»˜åˆ¶æ—¶å‡ºç°çš„ CORS é”™è¯¯é—®é¢˜.md","filePath":"zh-CN/ç¬”è®°/ğŸ› ï¸ å¼€å‘/è®°ä¸€æ¬¡ Canvas å†…å¼•ç”¨äº† OSS åŸŸçš„å›¾ç‰‡æ ‡ç­¾ç»˜åˆ¶æ—¶å‡ºç°çš„ CORS é”™è¯¯é—®é¢˜.md"}'),f={name:"zh-CN/ç¬”è®°/ğŸ› ï¸ å¼€å‘/è®°ä¸€æ¬¡ Canvas å†…å¼•ç”¨äº† OSS åŸŸçš„å›¾ç‰‡æ ‡ç­¾ç»˜åˆ¶æ—¶å‡ºç°çš„ CORS é”™è¯¯é—®é¢˜.md"};function C(S,s,b,v,O,m){const a=r("NolebasePageProperties"),n=r("VPNolebaseInlineLinkPreview"),d=r("NolebaseUnlazyImg"),p=r("NolebaseGitContributors"),g=r("NolebaseGitChangelog");return h(),u("div",null,[s[56]||(s[56]=l("h1",{id:"è®°ä¸€æ¬¡-canvas-å†…å¼•ç”¨äº†-oss-åŸŸçš„å›¾ç‰‡æ ‡ç­¾ç»˜åˆ¶æ—¶å‡ºç°çš„-cors-é”™è¯¯é—®é¢˜",tabindex:"-1"},[t("è®°ä¸€æ¬¡ Canvas å†…å¼•ç”¨äº† OSS åŸŸçš„å›¾ç‰‡æ ‡ç­¾ç»˜åˆ¶æ—¶å‡ºç°çš„ CORS é”™è¯¯é—®é¢˜ "),l("a",{class:"header-anchor",href:"#è®°ä¸€æ¬¡-canvas-å†…å¼•ç”¨äº†-oss-åŸŸçš„å›¾ç‰‡æ ‡ç­¾ç»˜åˆ¶æ—¶å‡ºç°çš„-cors-é”™è¯¯é—®é¢˜","aria-label":"Permalink to â€œè®°ä¸€æ¬¡ Canvas å†…å¼•ç”¨äº† OSS åŸŸçš„å›¾ç‰‡æ ‡ç­¾ç»˜åˆ¶æ—¶å‡ºç°çš„ CORS é”™è¯¯é—®é¢˜â€"},"â€‹")],-1)),e(a),s[57]||(s[57]=o("",6)),l("p",null,[s[1]||(s[1]=t("è°ƒæŸ¥æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°çš„æ—¶å€™å‘ç°æ˜¯å›¾ç‰‡ç›¸å…³çš„å“åº”æœªæ­£ç¡®æŒ‰ç…§ CORS æœŸæœ›çš„è®¾å®šè¿”å› ",-1)),s[2]||(s[2]=l("code",null,"Access-Control-Allow-Origin: *",-1)),s[3]||(s[3]=t(" å¤´éƒ¨ï¼Œè§¦å‘äº† CORS ç­–ç•¥é”™è¯¯å¯¼è‡´ã€‚ è€Œå¦‚æœä¸ä½¿ç”¨ CORS ç­–ç•¥ï¼ˆå³æ‰“å¼€ html2canvas é…ç½®é€‰é¡¹ä¸­çš„ ",-1)),s[4]||(s[4]=l("code",null,"useCORS: true",-1)),s[5]||(s[5]=t(" é€‰é¡¹ï¼‰è¯·æ±‚å›¾ç‰‡çš„è¯ï¼Œä¼šå¯¼è‡´ canvas å˜æˆä¸å®‰å…¨çš„ canvasï¼Œæˆ–è€…è¯´æ˜¯è¢«æ±¡æŸ“çš„ canvasï¼ˆå‚è§ï¼š",-1)),e(n,{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTML/CORS_enabled_image",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[0]||(s[0]=[t("å¯ç”¨äº† CORS çš„å›¾ç‰‡ - HTMLï¼ˆè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼‰ | MDN",-1)])]),_:1}),s[6]||(s[6]=t("ï¼‰ï¼Œåœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œå°†ä¸å¯ä½¿ç”¨ canvas ä¸Šä¸‹æ–‡ context è°ƒç”¨ä¸‹åˆ—å‡½æ•°ï¼š",-1))]),s[58]||(s[58]=o("",11)),l("p",null,[s[8]||(s[8]=t("åœ¨ç½‘ç»œä¸Šæœç´¢ç›¸å…³èµ„æ–™çš„æ—¶å€™å‘ç°å¤§å¤šæ•°äººéƒ½æåˆ°äº†ä¸€ä¸ªä¹‹å‰æˆ‘ä»¬å¼€å‘æ—¶å¿½ç•¥çš„ ",-1)),s[9]||(s[9]=l("code",null,"<img>",-1)),s[10]||(s[10]=t(" å±æ€§ ",-1)),s[11]||(s[11]=l("code",null,"crossorigin",-1)),s[12]||(s[12]=t("ï¼ˆå‚è€ƒèµ„æ–™ï¼š",-1)),e(n,{href:"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/crossOrigin#value",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[7]||(s[7]=[t("HTMLImageElement.crossOrigin - Web APIs | MDN",-1)])]),_:1}),s[13]||(s[13]=t("ï¼‰ã€‚",-1))]),s[59]||(s[59]=o("",4)),l("ul",null,[l("li",null,[l("p",null,[e(n,{href:"https://stackoverflow.com/questions/29105249/html2canvas-with-cors-in-s3-and-cloudfront",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[14]||(s[14]=[t("javascript - HTML2Canvas with CORS in S3 and CloudFront - Stack Overflow",-1)])]),_:1})])]),l("li",null,[l("p",null,[e(n,{href:"https://stackoverflow.com/questions/46257444/how-to-avoid-cors-error-when-drawing-image-onto-canvas",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[15]||(s[15]=[t("javascript - How to avoid CORS error when drawing image onto canvas? - Stack Overflow",-1)])]),_:1})])])]),s[60]||(s[60]=o("",9)),l("p",null,[s[17]||(s[17]=t("å…ˆå‰çš„é—®é¢˜è¿˜æ˜¯æ²¡æœ‰è§£å†³ï¼Œäºæ˜¯æˆ‘å»ç»§ç»­å¯»æ‰¾å…¶ä»–é—®é¢˜çš„ç­”æ¡ˆã€‚æœ‰å¦ä¸€ä¸ªé—®é¢˜æ˜¯å°éŸ³è¯¢é—®æˆ‘çš„ï¼š",-1)),s[18]||(s[18]=l("strong",null,[l("code",null,"<img>"),t(" æ ‡ç­¾èƒ½å¤ŸåŠ  crossorigin å±æ€§æ¥å¼ºåˆ¶ CORSï¼Œé‚£ CSS é‡Œé¢çš„å›¾ç‰‡æ€ä¹ˆåŠï¼Ÿ")],-1)),s[19]||(s[19]=t("ã€‚è¯´å®è¯æˆ‘ä¹Ÿä¸çŸ¥é“è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼Œäºæ˜¯åœ¨ç½‘ç»œä¸Šæœç´¢ã€‚ä¹Ÿå°±æ˜¯åœ¨è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘åœ¨ ",-1)),e(n,{href:"https://stackoverflow.com/questions/21638606/using-cors-headers-with-css-background-image",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[16]||(s[16]=[t("cross domain - Using CORS headers with CSS background-image - Stack Overflow",-1)])]),_:1}),s[20]||(s[20]=t(" StackOverflow é—®ç­”ä¸Šè§åˆ°äº†ä¸€å¥è¯„è®ºï¼š",-1))]),l("blockquote",null,[l("p",null,[s[23]||(s[23]=t(`After doing some research I have determined that the real problem is that Amazon S3 doesn't set the "Vary: Origin" header even if it is configured to support CORS. If anyone knows how to get S3 to do that, that would also be a good answer. â€“Â `,-1)),e(n,{href:"https://stackoverflow.com/users/2543666/thayne",title:"6,381 reputation",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[21]||(s[21]=[t("Thayne",-1)])]),_:1}),s[24]||(s[24]=t()),e(n,{href:"https://stackoverflow.com/questions/21638606/using-cors-headers-with-css-background-image#comment32821554_21638606",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[22]||(s[22]=[t("Feb 11, 2014 at 16:17",-1)])]),_:1})])]),s[61]||(s[61]=l("p",null,"æ„æ€æ˜¯è¯´ï¼š",-1)),s[62]||(s[62]=l("blockquote",null,[l("p",null,[t("åœ¨åšäº†ä¸€äº›ç ”ç©¶ä¹‹åï¼Œæˆ‘ç¡®å®šçœŸæ­£çš„é—®é¢˜æ˜¯å³ä½¿å°† Amazon S3 é…ç½®ä¸ºæ”¯æŒ CORS çš„æƒ…å†µä¸‹ï¼ŒAmazon S3 ä¾ç„¶æ²¡æœ‰"),l("strong",null,'è‡ªåŠ¨è®¾ç½® "Vary:Origin "å¤´'),t("ã€‚å¦‚æœæœ‰äººçŸ¥é“å¦‚ä½•è®©S3åšåˆ°è¿™ä¸€ç‚¹ï¼Œé‚£ä¹Ÿå°†æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç­”æ¡ˆã€‚")])],-1)),s[63]||(s[63]=l("p",null,[t("å’¦ï¼Œè¿™ä¸ª "),l("code",null,"Vary: Origin"),t(" çœ‹èµ·æ¥éå¸¸çœ¼ç†Ÿï¼Œä¹‹å‰åœ¨ OSS çš„è·¨åŸŸé…ç½®ä¸­çœ‹åˆ°è¿‡ï¼Œä½†æ˜¯ä»æœªä»”ç»†äº†è§£è¿‡å…·ä½“çš„å«ä¹‰ã€‚ä½†æ˜¯æˆ‘ä»¬èƒ½åœ¨å¦ä¸€ä¸ªå›ç­”ä¸­èƒ½æ‰¾åˆ°äº›è®¸çº¿ç´¢ï¼š")],-1)),l("blockquote",null,[l("p",null,[s[27]||(s[27]=t("Yes. If a request may contain aÂ ",-1)),s[28]||(s[28]=l("code",null,"Access-Control-Allow-Origin",-1)),s[29]||(s[29]=t("Â with different values, then the CDN should always respond withÂ ",-1)),s[30]||(s[30]=l("code",null,"Vary: Origin",-1)),s[31]||(s[31]=t(", even for responses without anÂ ",-1)),s[32]||(s[32]=l("code",null,"Access-Control-Allow-Origin",-1)),s[33]||(s[33]=t("Â header. Your analysis is correct: if the header isn't always present, it would be possible to fill the cache with incorrect values. â€“ ",-1)),e(n,{href:"https://stackoverflow.com/users/107250/monsur",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[25]||(s[25]=[t("monsur",-1)])]),_:1}),e(n,{href:"https://stackoverflow.com/a/25329887",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[26]||(s[26]=[t("answeredÂ Aug 15, 2014 at 16:02",-1)])]),_:1})])]),s[64]||(s[64]=l("p",null,"å…¶å«ä¹‰æ˜¯ï¼š",-1)),s[65]||(s[65]=l("blockquote",null,[l("p",null,[t("æ˜¯çš„ï¼Œå¦‚æœä¸€ä¸ªè¯·æ±‚å¯èƒ½åŒ…å«æœ‰ä¸åŒå€¼çš„ "),l("code",null,"Access-Control-Allow-Origin"),t("ï¼Œå³ä½¿è¯·æ±‚æ²¡æœ‰åŒ…å« "),l("code",null,"Access-Control-Allow-Origin"),t(" å¤´çš„å“åº”ï¼Œé‚£ä¹ˆ CDN åº”è¯¥æ€»æ˜¯åŒ…å«è¿”å› "),l("code",null,"Vary:Origin"),t(" å¤´éƒ¨ï¼Œä½ çš„åˆ†ææ˜¯æ­£ç¡®çš„ï¼šå¦‚æœå¤´ä¿¡æ¯ä¸æ€»æ˜¯å­˜åœ¨ï¼Œå°±æœ‰å¯èƒ½ç”¨ä¸æ­£ç¡®çš„å€¼å¡«å……ç¼“å­˜ã€‚")])],-1)),l("p",null,[s[35]||(s[35]=t("æ­¤æ—¶æ­¤åˆ»æˆ‘ä»¬å»å¯»æ‰¾ MDN å…³äº ",-1)),s[36]||(s[36]=l("code",null,"Vary",-1)),s[37]||(s[37]=t(" å¤´éƒ¨çš„æ–‡æ¡£ ",-1)),e(n,{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Vary",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[34]||(s[34]=[t("Vary - HTTP | MDN",-1)])]),_:1}),s[38]||(s[38]=t("ï¼Œå°±èƒ½çœ‹åˆ°ï¼š",-1))]),s[66]||(s[66]=l("blockquote",null,[l("p",null,[l("strong",null,[l("code",null,"Vary")]),t("Â æ˜¯ä¸€ä¸ª HTTP å“åº”å¤´éƒ¨ä¿¡æ¯ï¼Œå®ƒå†³å®šäº†å¯¹äºæœªæ¥çš„ä¸€ä¸ªè¯·æ±‚å¤´ï¼Œåº”è¯¥ç”¨ä¸€ä¸ªç¼“å­˜çš„å›å¤ (response) è¿˜æ˜¯å‘æºæœåŠ¡å™¨è¯·æ±‚ä¸€ä¸ªæ–°çš„å›å¤ã€‚")])],-1)),s[67]||(s[67]=l("p",null,"è¿™å¥è¯å¯èƒ½ä¸å¤ªèƒ½è¯´æ˜é—®é¢˜ï¼Œæˆ‘ä»¬ç»§ç»­çœ‹ MDN æä¾›çš„ä¸‹é¢çš„ä¾‹å­ï¼š",-1)),l("blockquote",null,[l("p",null,[s[40]||(s[40]=t("å“ªç§æƒ…å†µä¸‹ä½¿ç”¨ ",-1)),s[41]||(s[41]=l("code",null,"Vary",-1)),s[42]||(s[42]=t("ï¼Ÿå¯¹äº ",-1)),s[43]||(s[43]=l("code",null,"User-Agent",-1)),s[44]||(s[44]=t("Â å¤´éƒ¨ä¿¡æ¯ï¼Œä¾‹å¦‚ä½ æä¾›ç»™ç§»åŠ¨ç«¯çš„å†…å®¹æ˜¯ä¸åŒçš„ï¼Œå¯ç”¨é˜²æ­¢ä½ å®¢æˆ·ç«¯è¯¯ä½¿ç”¨äº†ç”¨äºæ¡Œé¢ç«¯çš„ç¼“å­˜ã€‚ å¹¶å¯å¸®åŠ© Google å’Œå…¶ä»–æœç´¢å¼•æ“æ¥å‘ç°ä½ çš„ç§»åŠ¨ç«¯ç‰ˆæœ¬çš„é¡µé¢ï¼ŒåŒæ—¶å‘ŠçŸ¥ä»–ä»¬ä¸éœ€è¦ ",-1)),e(n,{href:"https://en.wikipedia.org/wiki/Cloaking",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[39]||(s[39]=[t("Cloaking",-1)])]),_:1}),s[45]||(s[45]=t("ã€‚",-1))]),s[48]||(s[48]=l("p",null,[t("å³æ­¤æ—¶éœ€è¦è®¾ç½®ä¸º "),l("code",null,"Vary: User-Agent")],-1)),l("p",null,[s[47]||(s[47]=t("â€”â€” æ¥æº ",-1)),e(n,{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Vary#%E5%8A%A8%E6%80%81%E6%9C%8D%E5%8A%A1",title:"Permalink to åŠ¨æ€æœåŠ¡",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[46]||(s[46]=[t("åŠ¨æ€æœåŠ¡",-1)])]),_:1})])]),s[68]||(s[68]=l("p",null,[t("ä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬éœ€è¦æ ¹æ® User-Agent çš„ä¸åŒæŒ‡æŒ¥æµè§ˆå™¨å»è¯»å†™ç¼“å­˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä½¿ç”¨ "),l("code",null,"Vary: User-Agent"),t(" å¤´æ¥å®ç°ã€‚")],-1)),s[69]||(s[69]=l("p",null,[t("æ­¤åˆ»æˆ‘ä»¬å†å»çœ‹çœ‹é˜¿é‡Œäº‘ OSS çš„è·¨åŸŸè®¾ç½®é€‰é¡¹å½“ä¸­çš„æœ€åä¸€é¡¹ä¸‹é¢çš„æ³¨é‡Šï¼š"),l("strong",null,"è¿”å› Vary: Origin")],-1)),l("p",null,[e(d,{src:A,alt:"",thumbhash:"/fcFAYCplldYhPdU+w2131A=",placeholderSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAFCAYAAAAkG+5xAAACpElEQVR4AQCBAH7/AO3x8//v8/X/8/f5//f7/f/7/////f////3////8////+/////r+///7/////v//////////////////////////////////////////////////////////////////////////////////////////////////////////////AIEAfv8A7fHz/+/z9f/y9vj/9fn7//f7/f/3+/3/9fn7//L2+P/u8/X/6+/x/+ru8P/q7vD/7PHz//D09v/y9/n/9Pj6//T4+v/x9ff/7fHz/+jt7//l6ev/4+fp/+Pn6f/m6uz/6u7w/+3y9P/x9ff/8vb4//P3+f/y9vj/8fX3//D09v8AgQB+/wDy9vj/8/f5//X5+//3+/3/+Pz+//b6/P/y9vj/7fHz/+fr7f/i5uj/3+Pl/93h4//e4uT/3+Pl/+Hl5//h5ef/3+Pl/9zg4v/X297/09fZ/8/T1f/O0tT/z9PV/9LW2P/X293/3ODi/+Hl5//k6Or/5ers/+bq7P/l6ev/5enr/wCBAH7/APv////9//////////////////////////v////2+vz/8PT2/+vv8v/o7O7/5+vt/+js7v/p7vD/6+/x/+zw8v/q7vD/5+vt/+Lm6P/d4eP/2t7g/9jc3v/Z3d//3eHj/+Lm6P/o7O7/7fHz//H19//z9/n/9Pj6//T4+v/0+Pr/AYEAfv8A///////////////////////////////////////////+////+/////n9///5/f//+/////3////////////////////9////+Pz///T4+v/w9Pb/7vP1//D09v/z9/n/+Pz+//7///////////////////////////////////+3XmhW39ouuQAAAABJRU5ErkJggg==",autoSizes:"true",width:"1212",height:"246"})]),s[70]||(s[70]=l("p",null,[t("å…³é”®çš„ä¿¡æ¯æ˜¯ï¼š"),l("strong",null,"å¦‚æœæµè§ˆå™¨åŒæ—¶å­˜åœ¨ CORS å’Œé CORS è¯·æ±‚ï¼Œè¯·å¯ç”¨è¯¥é€‰é¡¹å¦åˆ™ä¼šå‡ºç°è·¨åŸŸé—®é¢˜ã€‚")],-1)),l("p",null,[s[50]||(s[50]=t("ç»¼ä¸Šæ‰€è¿°ï¼Œå¯¹äºåœ¨è·¨åŸŸåœºæ™¯ä¸‹çš„ GET è¯·æ±‚è€Œè¨€ï¼Œæˆ‘ä»¬èƒ½çŸ¥é“ç”±äº CORS ç­–ç•¥æ‰€äº§ç”Ÿçš„çš„ OPTIONS é¢„æ£€è¯·æ±‚ç›¸æ¯”é CORS ç­–ç•¥é™åˆ¶çš„çš„ GET è¯·æ±‚å¤šäº† ",-1)),s[51]||(s[51]=l("code",null,"Origin: <è¯·æ±‚æ¥æºåŸŸå>",-1)),s[52]||(s[52]=t(" å¤´éƒ¨ï¼Œé‚£ä¹ˆå…ˆå‰åœ¨ ",-1)),e(n,{href:"https://stackoverflow.com/questions/21638606/using-cors-headers-with-css-background-image",target:"_blank",rel:"noreferrer"},{default:i(()=>[...s[49]||(s[49]=[t("cross domain - Using CORS headers with CSS background-image - Stack Overflow",-1)])]),_:1}),s[53]||(s[53]=t(" StackOverflow é—®ç­”ä¸­çœ‹åˆ°çš„è¯„è®ºæ‰€æåˆ°çš„ ",-1)),s[54]||(s[54]=l("code",null,"Vary: Origin",-1)),s[55]||(s[55]=t(" å¤´éƒ¨çš„ä½œç”¨å°±å¯ä»¥ç†è§£ä¸ºï¼š",-1))]),s[71]||(s[71]=o("",6)),e(p),e(g)])}const P=k(f,[["render",C]]);export{B as __pageData,P as default};
