import{_ as d,ad as t,c as o,o as c,b as i,k as l,aE as h,a5 as a,m as e}from"./chunks/framework.BN_kmrHV.js";const m=JSON.parse('{"title":"ä½¿ç”¨ Docker å®‰è£…å’Œéƒ¨ç½² ELK","description":"","frontmatter":{"tags":["å‘½ä»¤è¡Œ/docker","å¼€å‘/å®¹å™¨åŒ–/Docker","å¼€å‘/äº‘åŸç”Ÿ/Docker","è½¯ä»¶/äº‘åŸç”Ÿ/docker","å¼€å‘/äº‘åŸç”Ÿ/å¯è§‚æµ‹","è½¯ä»¶/Elastic","è½¯ä»¶/Elastic/ELK","è½¯ä»¶/Elastic/ElasticStack","è½¯ä»¶/Elastic/ElasticSearch","è½¯ä»¶/Elastic/Kibana","è½¯ä»¶/Elastic/Logstash","å¼€å‘/äº‘åŸç”Ÿ/å¯è§‚æµ‹/æ—¥å¿—","å¼€å‘/äº‘åŸç”Ÿ/å¯è§‚æµ‹/æŒ‡æ ‡","å¼€å‘/äº‘åŸç”Ÿ/å¯è§‚æµ‹/ç›‘æ§","åŸºç¡€è®¾æ–½","å‘½ä»¤è¡Œ/apt","æ“ä½œç³»ç»Ÿ/Debian","æ“ä½œç³»ç»Ÿ/Debian/Debian-11","å¼€å‘/æ ‡è®°è¯­è¨€/YAML","å¼€å‘/å®¹å™¨åŒ–/Docker/Docker-Compose","å‘½ä»¤è¡Œ/sysctl","å‘½ä»¤è¡Œ/curl"]},"headers":[],"relativePath":"zh-CN/ç¬”è®°/ğŸ§± åŸºç¡€è®¾æ–½/ğŸ” Elastic Stack (ELK)/å®‰è£… ELK.md","filePath":"zh-CN/ç¬”è®°/ğŸ§± åŸºç¡€è®¾æ–½/ğŸ” Elastic Stack (ELK)/å®‰è£… ELK.md"}'),g={name:"zh-CN/ç¬”è®°/ğŸ§± åŸºç¡€è®¾æ–½/ğŸ” Elastic Stack (ELK)/å®‰è£… ELK.md"},y={tabindex:"0"};function b(C,s,F,u,B,E){const k=t("NolebasePageProperties"),n=t("VPNolebaseInlineLinkPreview"),p=t("NolebaseGitContributors"),r=t("NolebaseGitChangelog");return c(),o("div",null,[s[20]||(s[20]=i("h1",{id:"ä½¿ç”¨-docker-å®‰è£…å’Œéƒ¨ç½²-elk",tabindex:"-1"},[a("ä½¿ç”¨ Docker å®‰è£…å’Œéƒ¨ç½² ELK "),i("a",{class:"header-anchor",href:"#ä½¿ç”¨-docker-å®‰è£…å’Œéƒ¨ç½²-elk","aria-label":"Permalink to â€œä½¿ç”¨ Docker å®‰è£…å’Œéƒ¨ç½² ELKâ€"},"â€‹")],-1)),l(k),s[21]||(s[21]=i("p",null,[i("strong",null,"ELK å³ ElasticSearchã€Logstashã€Kibana æ ˆï¼Œç”¨äºæ—¥å¿—åˆ†æã€æ—¥å¿—æœç´¢ã€‚")],-1)),s[22]||(s[22]=i("h3",{id:"æ–‡æ¡£å…¼å®¹æ€§",tabindex:"-1"},[a("æ–‡æ¡£å…¼å®¹æ€§ "),i("a",{class:"header-anchor",href:"#æ–‡æ¡£å…¼å®¹æ€§","aria-label":"Permalink to â€œæ–‡æ¡£å…¼å®¹æ€§â€"},"â€‹")],-1)),i("table",y,[s[12]||(s[12]=i("thead",null,[i("tr",null,[i("th",null,"ä¸»ä½“"),i("th",null,"ç‰ˆæœ¬å·"),i("th",null,"æ–‡æ¡£åœ°å€ï¼ˆå¦‚æœæœ‰ï¼‰")])],-1)),i("tbody",null,[i("tr",null,[s[1]||(s[1]=i("td",null,"ElasticSearch Docker é•œåƒ",-1)),s[2]||(s[2]=i("td",null,"7.16.3",-1)),i("td",null,[l(n,{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/setup.html",target:"_blank",rel:"noreferrer"},{default:e(()=>[...s[0]||(s[0]=[a("https://www.elastic.co/guide/en/elasticsearch/reference/current/setup.html",-1)])]),_:1})])]),i("tr",null,[s[4]||(s[4]=i("td",null,"Kibana",-1)),s[5]||(s[5]=i("td",null,"7.16.3",-1)),i("td",null,[l(n,{href:"https://www.elastic.co/guide/en/kibana/current/docker.html",target:"_blank",rel:"noreferrer"},{default:e(()=>[...s[3]||(s[3]=[a("https://www.elastic.co/guide/en/kibana/current/docker.html",-1)])]),_:1})])]),i("tr",null,[s[7]||(s[7]=i("td",null,"Docker",-1)),s[8]||(s[8]=i("td",null,"20.10.5+dfsg1",-1)),i("td",null,[l(n,{href:"https://docs.docker.com/",target:"_blank",rel:"noreferrer"},{default:e(()=>[...s[6]||(s[6]=[a("https://docs.docker.com/",-1)])]),_:1})])]),i("tr",null,[s[10]||(s[10]=i("td",null,"docker-compose",-1)),s[11]||(s[11]=i("td",null,"1.25.0",-1)),i("td",null,[l(n,{href:"https://docs.docker.com/compose/",target:"_blank",rel:"noreferrer"},{default:e(()=>[...s[9]||(s[9]=[a("https://docs.docker.com/compose/",-1)])]),_:1})])])])]),s[23]||(s[23]=h('<h2 id="æœºå™¨å‚æ•°è¦æ±‚" tabindex="-1">æœºå™¨å‚æ•°è¦æ±‚ <a class="header-anchor" href="#æœºå™¨å‚æ•°è¦æ±‚" aria-label="Permalink to â€œæœºå™¨å‚æ•°è¦æ±‚â€">â€‹</a></h2><p>æœ€å°‘ 3 GB å†…å­˜ï¼Œä¸¤ä¸ª node è‡³å°‘ä¼šéœ€è¦ 1 G çš„è¿å­˜ï¼Œè¿˜è¦è€ƒè™‘åˆ°å¯¹ ElasticSearch èŠ‚ç‚¹çš„ç›‘æ§ï¼ˆä½¿ç”¨ node-exporter è¿›è¡ŒèŠ‚ç‚¹ç›‘æ§ï¼‰</p><h2 id="å‰ç½®å·¥ä½œ" tabindex="-1">å‰ç½®å·¥ä½œ <a class="header-anchor" href="#å‰ç½®å·¥ä½œ" aria-label="Permalink to â€œå‰ç½®å·¥ä½œâ€">â€‹</a></h2><h3 id="å®‰è£…-docker" tabindex="-1">å®‰è£… Docker <a class="header-anchor" href="#å®‰è£…-docker" aria-label="Permalink to â€œå®‰è£… Dockerâ€">â€‹</a></h3>',4)),i("p",null,[s[14]||(s[14]=a("å¯ä»¥å‚è€ƒå®˜æ–¹æŒ‡å—åœ¨ Debian 11 ä¸Šå®‰è£… Dockerï¼š",-1)),l(n,{href:"https://docs.docker.com/engine/install/debian/",target:"_blank",rel:"noreferrer"},{default:e(()=>[...s[13]||(s[13]=[a("Install Docker Engine on Debian | Docker Documentation",-1)])]),_:1})]),s[24]||(s[24]=h(`<p>ä¹Ÿå¯ä»¥æ‰§è¡Œä¸‹é¢çš„è„šæœ¬ï¼Œæ¯æ¬¡ä¸€è¡Œï¼š</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update</span></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ca-certificates</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> curl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gnupg</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lsb-release</span></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -fsSL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://download.docker.com/linux/debian/gpg</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gpg</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --dearmor</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /usr/share/keyrings/docker-archive-keyring.gpg</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;deb [arch=$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --print-architecture</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lsb_release</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -cs</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">) stable&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list.d/docker.list</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /dev/null</span></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update</span></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docker-ce</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docker-ce-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> containerd.io</span></span></code></pre></div><h3 id="å®‰è£…-docker-compose" tabindex="-1">å®‰è£… docker-compose <a class="header-anchor" href="#å®‰è£…-docker-compose" aria-label="Permalink to â€œå®‰è£… docker-composeâ€">â€‹</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docker-compose</span></span></code></pre></div><h2 id="éƒ¨ç½²-elasticsearch-æœç´¢å¼•æ“" tabindex="-1">éƒ¨ç½² ElasticSearch æœç´¢å¼•æ“ <a class="header-anchor" href="#éƒ¨ç½²-elasticsearch-æœç´¢å¼•æ“" aria-label="Permalink to â€œéƒ¨ç½² ElasticSearch æœç´¢å¼•æ“â€">â€‹</a></h2><h3 id="æ‹‰å–-elasticsearch-é•œåƒ" tabindex="-1">æ‹‰å– ElasticSearch é•œåƒ <a class="header-anchor" href="#æ‹‰å–-elasticsearch-é•œåƒ" aria-label="Permalink to â€œæ‹‰å– ElasticSearch é•œåƒâ€">â€‹</a></h3>`,10)),i("p",null,[s[16]||(s[16]=a("æ­¤å¤„å¼•ç”¨äº† ",-1)),s[17]||(s[17]=i("code",null,"docker.elastic.co/elasticsearch/elasticsearch:7.16.3",-1)),s[18]||(s[18]=a(" é•œåƒï¼Œå¤§å®¶å¯ä»¥å‰å¾€ ",-1)),l(n,{href:"https://www.docker.elastic.co/r/elasticsearch",target:"_blank",rel:"noreferrer"},{default:e(()=>[...s[15]||(s[15]=[a("Elastic Docker æ³¨å†Œä¸­å¿ƒ",-1)])]),_:1}),s[19]||(s[19]=a(" æŸ¥çœ‹å½“å‰å¯ç”¨çš„ ElasticSearch é•œåƒæ ‡ç­¾ã€‚",-1))]),s[25]||(s[25]=h(`<div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docker.elastic.co/elasticsearch/elasticsearch:7.16.3</span></span></code></pre></div><h3 id="æ’°å†™-elasticsearch-çš„-docker-compose-yaml-æ–‡ä»¶" tabindex="-1">æ’°å†™ ElasticSearch çš„ docker-compose.yaml æ–‡ä»¶ <a class="header-anchor" href="#æ’°å†™-elasticsearch-çš„-docker-compose-yaml-æ–‡ä»¶" aria-label="Permalink to â€œæ’°å†™ ElasticSearch çš„ docker-compose.yaml æ–‡ä»¶â€">â€‹</a></h3><p>é€šè¿‡ <code>docker-compose.yaml</code> é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶éƒ¨ç½²å¤šä¸ªæœåŠ¡ï¼Œå¹¶ä¸”åˆ›å»ºå¯¹åº”çš„ç½‘ç»œå°†è¿™äº›ç½‘ç»œè¿æ¥åˆ°ä¸€èµ·ã€‚</p><p><code>docker-compose.yaml</code> æ–‡ä»¶å¦‚ä¸‹ï¼š</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;2.2&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  es01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docker.elastic.co/elasticsearch/elasticsearch:7.16.3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    container_name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">es01</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">node.name=es01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">cluster.name=es-docker-cluster</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">discovery.seed_hosts=es02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">cluster.initial_master_nodes=es01,es02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">bootstrap.memory_lock=true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ES_JAVA_OPTS=-Xms512m -Xmx512m</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    ulimits</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memlock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        soft</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">-1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        hard</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">-1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">data01:/usr/share/elasticsearch/data</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">9200:9200</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    networks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">elastic</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  es02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docker.elastic.co/elasticsearch/elasticsearch:7.16.3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    container_name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">es02</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">node.name=es02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">cluster.name=es-docker-cluster</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">discovery.seed_hosts=es01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">cluster.initial_master_nodes=es01,es02</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">bootstrap.memory_lock=true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ES_JAVA_OPTS=-Xms512m -Xmx512m</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    ulimits</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memlock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        soft</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">-1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        hard</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">-1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">data02:/usr/share/elasticsearch/data</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    networks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">elastic</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  data01</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    driver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">local</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  data02</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    driver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">local</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">networks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  elastic</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    driver</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">bridge</span></span></code></pre></div><p>æˆ‘æŠŠè¿™ä¸ªæ–‡ä»¶ä¿å­˜åˆ°äº† <code>/opt/elk/elasticsearch/docker-compose.yaml</code> è·¯å¾„ï¼Œå®‰è£…æ—¶æŒ‰éœ€è°ƒæ•´å³å¯ã€‚</p><h3 id="é¢„è®¾å®šå‚æ•°" tabindex="-1">é¢„è®¾å®šå‚æ•° <a class="header-anchor" href="#é¢„è®¾å®šå‚æ•°" aria-label="Permalink to â€œé¢„è®¾å®šå‚æ•°â€">â€‹</a></h3><p>ç”±äºæ˜¯åœ¨ Docker ç¯å¢ƒä¸­è¿è¡Œï¼Œæˆ‘ä»¬è¿˜éœ€è¦è°ƒæ•´ä¸€ä¸‹ <code>vm.max_map_count</code> å‚æ•°å€¼ï¼Œè¯¥å‚æ•°çš„å«ä¹‰ï¼šé™åˆ¶ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æ‹¥æœ‰çš„VMAï¼ˆè™šæ‹Ÿå†…å­˜åŒºåŸŸï¼‰çš„æ•°é‡ã€‚</p><blockquote><p>The <code>vm.max_map_count</code> kernel setting must be set to at least <code>262144</code> for production use.</p></blockquote><p>æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„è¯´æ³•ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ <code>vm.max_map_count</code> çš„å‚æ•°å€¼è®¾å®šåˆ° <code>262144</code> ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sysctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -w</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> vm.max_map_count=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">262144</span></span></code></pre></div><h2 id="å¼€å§‹è¿è¡Œ-elasticsearch-èŠ‚ç‚¹" tabindex="-1">å¼€å§‹è¿è¡Œ ElasticSearch èŠ‚ç‚¹ <a class="header-anchor" href="#å¼€å§‹è¿è¡Œ-elasticsearch-èŠ‚ç‚¹" aria-label="Permalink to â€œå¼€å§‹è¿è¡Œ ElasticSearch èŠ‚ç‚¹â€">â€‹</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docker-compose</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -d</span></span></code></pre></div><h3 id="æµ‹è¯•æ•ˆæœ" tabindex="-1">æµ‹è¯•æ•ˆæœ <a class="header-anchor" href="#æµ‹è¯•æ•ˆæœ" aria-label="Permalink to â€œæµ‹è¯•æ•ˆæœâ€">â€‹</a></h3><p>é€šè¿‡ SSH è‡ªå¸¦çš„ç«¯å£è½¬å‘æ¥è½¬å‘æœåŠ¡ç«¯çš„ç«¯å£åˆ°æœ¬åœ°è¿›è¡Œè®¿é—®ï¼š</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> elastic-node-01</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 9200:127.0.0.1:9200</span></span></code></pre></div><p>è®¿é—®èŠ‚ç‚¹ä¿¡æ¯ï¼š</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GET</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;localhost:9200/_cat/nodes?v=true&amp;pretty&quot;</span></span></code></pre></div><h2 id="éƒ¨ç½²-kibana-æœç´¢-ui" tabindex="-1">éƒ¨ç½² Kibana æœç´¢ UI <a class="header-anchor" href="#éƒ¨ç½²-kibana-æœç´¢-ui" aria-label="Permalink to â€œéƒ¨ç½² Kibana æœç´¢ UIâ€">â€‹</a></h2><p>è®¿é—® <code>http://localhost:5601</code> å³å¯</p><h3 id="æ‹‰å–-kibana-é•œåƒ" tabindex="-1">æ‹‰å– Kibana é•œåƒ <a class="header-anchor" href="#æ‹‰å–-kibana-é•œåƒ" aria-label="Permalink to â€œæ‹‰å– Kibana é•œåƒâ€">â€‹</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docker.elastic.co/kibana/kibana:7.16.3</span></span></code></pre></div><h3 id="æ’°å†™-kibana-é…ç½®æ–‡ä»¶" tabindex="-1">æ’°å†™ Kibana é…ç½®æ–‡ä»¶ <a class="header-anchor" href="#æ’°å†™-kibana-é…ç½®æ–‡ä»¶" aria-label="Permalink to â€œæ’°å†™ Kibana é…ç½®æ–‡ä»¶â€">â€‹</a></h3><p><code>kibana.yml</code>:</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">server.host</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">server.shutdownTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">5s</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">elasticsearch.hosts</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;http://es01:9200&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">monitoring.ui.container.elasticsearch.enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä¸­æ–‡æœ¬åœ°åŒ–</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">i18n.locale</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">zh-CN</span></span></code></pre></div><p>æˆ‘æŠŠè¿™ä¸ªé…ç½®æ–‡ä»¶æ”¾åˆ°äº† <code>/opt/elk/kibana/config/kibana.yml</code></p><h3 id="åˆ›å»ºå®¹å™¨" tabindex="-1">åˆ›å»ºå®¹å™¨ <a class="header-anchor" href="#åˆ›å»ºå®¹å™¨" aria-label="Permalink to â€œåˆ›å»ºå®¹å™¨â€">â€‹</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kib01</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --net</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> elasticsearch_elastic</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 127.0.0.1:5601:5601</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;ELASTICSEARCH_HOSTS=http://es01:9200&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /opt/elk/kibana/config/kibana.yml:/usr/share/kibana/config/kibana.yml</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> docker.elastic.co/kibana/kibana:7.16.3</span></span></code></pre></div><h3 id="æµ‹è¯•æ•ˆæœ-1" tabindex="-1">æµ‹è¯•æ•ˆæœ <a class="header-anchor" href="#æµ‹è¯•æ•ˆæœ-1" aria-label="Permalink to â€œæµ‹è¯•æ•ˆæœâ€">â€‹</a></h3><p>é€šè¿‡ SSH è‡ªå¸¦çš„ç«¯å£è½¬å‘æ¥è½¬å‘æœåŠ¡ç«¯çš„ç«¯å£åˆ°æœ¬åœ°è¿›è¡Œè®¿é—®ï¼š</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> elastic-node-01</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5601:127.0.0.1:5601</span></span></code></pre></div><p>æµè§ˆå™¨è®¿é—® <code>http://localhost:5601</code> å³å¯çœ‹åˆ°æ•ˆæœ</p><h3 id="kibana-é”™è¯¯æ’æŸ¥" tabindex="-1">Kibana é”™è¯¯æ’æŸ¥ <a class="header-anchor" href="#kibana-é”™è¯¯æ’æŸ¥" aria-label="Permalink to â€œKibana é”™è¯¯æ’æŸ¥â€">â€‹</a></h3><h4 id="something-went-wrong" tabindex="-1">Something went wrong <a class="header-anchor" href="#something-went-wrong" aria-label="Permalink to â€œSomething went wrongâ€">â€‹</a></h4><p>å¦‚æœä½ é‡åˆ°äº†è¿™ä¸ªé”™è¯¯ï¼Œå¹¶ä¸”ä¸‹æ–¹çº¢æ¡†å†…é”™è¯¯æç¤ºä¸ºï¼š<strong>Request must contain a kbn-xsrf header.</strong> åˆ™è¯´æ˜å½“å‰ Header å¤´éƒ¨ä¸­éœ€è¦æ·»åŠ  <code>kbn-xsrf</code> å¤´éƒ¨å­—æ®µã€‚</p><p>Chrome æµè§ˆå™¨å¯ä»¥ç”¨ ModHeader æ’ä»¶æ¥å®Œæˆã€‚ æœåŠ¡ç«¯å¯ä»¥è®¾å®šä¸€ä¸ªè¿”å›çš„ Header æ¥è§£å†³è¯¥é—®é¢˜ã€‚</p>`,36)),l(p),l(r)])}const f=d(g,[["render",b]]);export{m as __pageData,f as default};
