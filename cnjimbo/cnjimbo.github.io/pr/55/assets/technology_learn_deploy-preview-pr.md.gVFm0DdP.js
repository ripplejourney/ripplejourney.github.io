import{j as e,b as s,c as a,a7 as i}from"./chunks/framework.C7slW6zq.js";const g=JSON.parse('{"title":"åœ¨æäº¤prè¯·æ±‚åè‡ªåŠ¨éƒ¨ç½²preview github pages","description":"","frontmatter":{"title":"åœ¨æäº¤prè¯·æ±‚åè‡ªåŠ¨éƒ¨ç½²preview github pages","date":"2024-06-18T00:00:00.000Z","tags":["æŠ€æœ¯ç¬”è®°","æŠ€æœ¯æ•™ç¨‹","github","actions","deploy","preview"],"categories":["github","actions","deploy","preview"],"created":"2024-06-18T20:04:04 (UTC +08:00)","source":null,"author":"EndBug"},"headers":[],"relativePath":"technology/learn/deploy-preview-pr.md","filePath":"technology/learn/deploy-preview-pr.md","lastUpdated":1718713780000}'),t={name:"technology/learn/deploy-preview-pr.md"},n=i(`<h1 id="åœ¨æäº¤prè¯·æ±‚åè‡ªåŠ¨éƒ¨ç½²preview-github-pages" tabindex="-1">åœ¨æäº¤prè¯·æ±‚åè‡ªåŠ¨éƒ¨ç½²preview github pages <a class="header-anchor" href="#åœ¨æäº¤prè¯·æ±‚åè‡ªåŠ¨éƒ¨ç½²preview-github-pages" aria-label="Permalink to &quot;åœ¨æäº¤prè¯·æ±‚åè‡ªåŠ¨éƒ¨ç½²preview github pages&quot;">â€‹</a></h1><blockquote><h2 id="excerpt" tabindex="-1">Excerpt <a class="header-anchor" href="#excerpt" aria-label="Permalink to &quot;Excerpt&quot;">â€‹</a></h2><p>:octocat: ä¸€ä¸ªGitHub Actionï¼Œç”¨äºä¸ºæ‹‰å–è¯·æ±‚ï¼ˆPRï¼‰å’Œåˆ†æ”¯åˆ›å»ºGitHub Pagesé¢„è§ˆ â€”â€” EndBug/pages-preview</p></blockquote><h2 id="table-of-contents" tabindex="-1">Table of contents <a class="header-anchor" href="#table-of-contents" aria-label="Permalink to &quot;Table of contents&quot;">â€‹</a></h2><ul><li><a href="#what-does-it-do">What does it do?</a></li><li><a href="#setup">Setup</a></li><li><a href="#inputs">Inputs</a></li></ul><h2 id="what-does-it-do" tabindex="-1">What does it do? <a class="header-anchor" href="#what-does-it-do" aria-label="Permalink to &quot;What does it do?&quot;">â€‹</a></h2><p>è®¸å¤šç¬¬ä¸‰æ–¹æœåŠ¡å…è®¸æ‚¨åˆ›å»ºåˆ†æ”¯å’Œæ‹‰å–è¯·æ±‚çš„é¢„è§ˆéƒ¨ç½²ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥åˆ©ç”¨è¿™äº›é¢„è§ˆæ¥å®¡æŸ¥å’Œæµ‹è¯•æ‚¨çš„æ›´æ”¹ã€‚æ­¤æ“ä½œåŒæ ·èƒ½å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œä½†å®ƒæ˜¯ç›´æ¥é€šè¿‡GitHub Pagesæ¥å®Œæˆã€‚</p><p>å…·ä½“è€Œè¨€ï¼Œæ­¤æ“ä½œä¼šå°†æ‚¨çš„ç½‘ç«™éƒ¨ç½²åˆ°ä¸€ä¸ªä¸åŒçš„ä»“åº“ä¸­ï¼Œè¯¥ä»“åº“å°†ä¼šåŒ…å«æ‚¨é€‰æ‹©åº”ç”¨æ­¤æ“ä½œçš„æ‰€æœ‰ä»“åº“çš„é¢„è§ˆç‰ˆæœ¬ã€‚</p><p>å¦‚æœæ‚¨å¯¹è¿™ä¸ªæ“ä½œèƒŒåçš„é€»è¾‘æ„Ÿå…´è¶£ï¼Œæ‚¨å¯ä»¥æŸ¥é˜…<a href="./docs/flow_diagram.html">æµç¨‹å›¾æ–‡æ¡£</a>ã€‚</p><h2 id="setup" tabindex="-1">Setup <a class="header-anchor" href="#setup" aria-label="Permalink to &quot;Setup&quot;">â€‹</a></h2><h3 id="preview-repo" tabindex="-1">Preview repo <a class="header-anchor" href="#preview-repo" aria-label="Permalink to &quot;Preview repo&quot;">â€‹</a></h3><h4 id="using-my-template" tabindex="-1">Using my template <a class="header-anchor" href="#using-my-template" aria-label="Permalink to &quot;Using my template&quot;">â€‹</a></h4><ol><li><p>é¦–å…ˆï¼Œè®¿é—®<a href="https://github.com/EndBug/preview-template" target="_blank" rel="noreferrer">æ­¤æ¨¡æ¿</a>ï¼Œå¹¶ä»é‚£é‡Œç”Ÿæˆæ‚¨çš„ä»“åº“ï¼šç‚¹å‡»<code>Use this template</code>ï¼Œå¡«å†™ä»“åº“åç§°å’Œæè¿°ï¼Œç¡®è®¤å·²å‹¾é€‰ <code>Include all branches</code>ï¼Œç„¶ååˆ›å»ºä»“åº“ã€‚</p></li><li><p>æ¥ç€ï¼Œè¿›å…¥æ‚¨çš„ä»“åº“è®¾ç½®ï¼Œåœ¨â€œPagesâ€ï¼ˆä»“åº“è®¾ç½®&gt; Pagesï¼‰é€‰é¡¹å¡ä¸­ï¼Œå°†â€œGitHub Actionsâ€è®¾ç½®ä¸ºæºã€‚è¿™æ ·é…ç½®åï¼Œæ¯å½“æœ‰æ–°çš„æ¨é€æˆ–æ‹‰å–è¯·æ±‚ï¼ŒGitHub Actionså°†è‡ªåŠ¨éƒ¨ç½²é¢„è§ˆé¡µé¢ã€‚</p></li></ol><h4 id="manually" tabindex="-1">Manually <a class="header-anchor" href="#manually" aria-label="Permalink to &quot;Manually&quot;">â€‹</a></h4><ol><li><p>åˆ›å»ºä¸€ä¸ªæ–°çš„å­˜å‚¨åº“ä»¥æ‰¿è½½ä½ çš„é¢„è§ˆå†…å®¹ã€‚ è¿™ä¸ªå­˜å‚¨åº“å°†ç”¨äºæ¥è‡ªä½ æ‰€æœ‰å­˜å‚¨åº“çš„é¢„è§ˆï¼Œå› æ­¤ä½ åªéœ€è¦ä¸€æ¬¡æ€§è®¾ç½®å®ƒã€‚</p></li><li><p>ç¡®ä¿è¿™ä¸ªå­˜å‚¨åº“åŒ…å«ä¸¤ä¸ªåˆ†æ”¯ï¼š<code>main</code> å’Œ <code>gh-pages</code>ï¼ˆä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä¸åŒçš„åç§°ï¼‰ã€‚</p><ul><li><code>main</code> åº”è¯¥æ˜¯ä½ çš„é»˜è®¤åˆ†æ”¯ï¼Œå®ƒä»…ä¿å­˜å·¥ä½œæµæ–‡ä»¶ï¼ˆä»¥åŠä½ å¯èƒ½æƒ³è¦æ·»åŠ çš„å…¶ä»–æ–‡ä»¶ï¼Œå¦‚ READMEã€è®¸å¯è¯ç­‰ï¼‰ã€‚</li><li><code>gh-pages</code> åˆ†æ”¯å°†åŒ…å«å®é™…çš„é¢„è§ˆå†…å®¹ï¼Œåˆå§‹åŒ–æ—¶åº”ä¸ºç©ºã€‚</li></ul></li><li><p>åœ¨ <code>main</code> åˆ†æ”¯ä¸­åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå¹¶å°†å…¶å‘½åä¸º <code>.github/workflows/preview.yml</code>ã€‚ç„¶åï¼Œå°† <code>[</code>dependents/preview-repo.yml<code>](dependents/preview_repo.yml)</code> ä¸­çš„å†…å®¹å¤åˆ¶åˆ°è¯¥æ–‡ä»¶ä¸­ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ æ— éœ€ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ä¸­çš„ä»»ä½•å†…å®¹ï¼Œæ‰€æœ‰é…ç½®é€‰é¡¹éƒ½åº”åœ¨æºå­˜å‚¨åº“çš„å·¥ä½œæµä¸­è®¾å®šã€‚ å¦‚æœä½ æ›´æ–°åŠ¨ä½œåˆ°ä¸åŒçš„ä¸»è¦ç‰ˆæœ¬ï¼Œè¿™ä¸ªæ–‡ä»¶å¯èƒ½éœ€è¦è¿›è¡Œç›¸åº”çš„æ›´æ–°ã€‚</p></li><li><p>è¿›å…¥ä½ çš„å­˜å‚¨åº“è®¾ç½®ï¼Œåœ¨â€œPagesâ€æ ‡ç­¾é¡µä¸‹ï¼ˆä»“åº“è®¾ç½® &gt; Pagesï¼‰ï¼Œå¹¶å°†â€œGitHub Actionsâ€è®¾ä¸ºé¡µé¢å‘å¸ƒæ¥æºã€‚</p></li></ol><h3 id="personal-access-token-pat" tabindex="-1">Personal Access Token (PAT) <a class="header-anchor" href="#personal-access-token-pat" aria-label="Permalink to &quot;Personal Access Token (PAT)&quot;">â€‹</a></h3><p>In order for the action to be able to trigger the deployment in the preview repo from the source repo, you&#39;ll need to create a Personal Access Token (PAT).</p><p>There are currently two types of PATs: fine-grained, which are more secure but still in beta, and classic. I&#39;d suggest to use fine-grained PATs, but if you can&#39;t, you can also use classic PATs.</p><h4 id="fine-grained-pat" tabindex="-1">Fine-grained PAT <a class="header-anchor" href="#fine-grained-pat" aria-label="Permalink to &quot;Fine-grained PAT&quot;">â€‹</a></h4><ol><li>Go to <a href="https://github.com/settings/tokens?type=beta" target="_blank" rel="noreferrer">Account settings &gt; Developer settings &gt; Fine-grained tokens</a>.</li><li>Click on &quot;Generate new token&quot;.</li><li>Give it a recognizable name and set an appropriate expiration date.</li><li>Make sure that the &quot;Resource owner&quot; is the same user/org that owns the preview repo.</li><li>Set the &quot;Repository access&quot; to &quot;Only selected repositories&quot; and then select the preview repo.</li><li>In the &quot;Repository permissions&quot; sections, set &quot;Actions&quot; and &quot;Content&quot; to &quot;Read and write&quot;. &quot;Metadata&quot; will also be granted as &quot;Read-only&quot;, as it is required for the other two.</li><li>Click on &quot;Generate token&quot;, copy the token and save it somewhere for later.</li></ol><h4 id="classic-pat" tabindex="-1">Classic PAT <a class="header-anchor" href="#classic-pat" aria-label="Permalink to &quot;Classic PAT&quot;">â€‹</a></h4><ol><li>Go to <a href="https://github.com/settings/tokens" target="_blank" rel="noreferrer">Account settings &gt; Developer settings &gt; Tokens (classic)</a>.</li><li>Click on &quot;Generate new token&quot; &gt; &quot;Generate new token (classic)&quot;</li><li>Give it a recognizable name and set an appropriate expiration date.</li><li>Select the <code>repo</code> scope.</li><li>Click on &quot;Generate token&quot;, copy the token and save it somewhere for later.</li></ol><h3 id="source-repo" tabindex="-1">Source repo <a class="header-anchor" href="#source-repo" aria-label="Permalink to &quot;Source repo&quot;">â€‹</a></h3><p>This steps need to be repeated for each repo you want to use this action on.</p><ol><li>Go to the repo that contains the source code of your website.</li><li>Go to Repo settings &gt; Secrets and variables &gt; Actions.</li><li>Create a new repository secret called <code>PREVIEW_TOKEN</code> and paste the PAT you created in the previous step.</li><li>Go back to the repo contents and add the deployment workflow: you can either create a new one or add the same steps to your existing one. Use the <a href="dependents/source_repo.yml"><code>dependents/source-repo.yml</code></a> file as a template/example. Make sure to change the <code>PREVIEW_REPO</code> and <code>PAGES_BASE</code> env variable, along with the commands needed to build your website. Also, make sure to change <code>EndBug/pages-preview</code>&#39;s inputs to match your needs: more info on that in the <a href="#inputs">&quot;Inputs&quot;</a> section of this file.</li></ol><p>All done! You&#39;re now ready to use the action ğŸ‰</p><h2 id="inputs" tabindex="-1">Inputs <a class="header-anchor" href="#inputs" aria-label="Permalink to &quot;Inputs&quot;">â€‹</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EndBug/pages-preview@v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # The directory in which the website has been built, in the a/b/c format</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    build_dir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # The GitHub Pages base URL of the preview repo</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    preview_base_url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://octocat.github.io/preview</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # The repository to push previews to, in the Owner/Name format</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    preview_repo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octocat/preview</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # The token to access the preview repo, that you created during setup</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    preview_token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${{ secrets.PREVIEW_TOKEN }}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # --- OPTIONAL ---</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # The name of the environment to use for the deployment</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Default: &#39;preview&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    deployment_env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;development&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Whether to use the deployments API</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Default: &#39;true&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    deployments</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # The name of the author of the resulting commit</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Default: the GitHub Actor</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    git_author_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Mona</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # The email of the author of the resulting commit</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Default: the GitHub Actor&#39;s</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    git_committer_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mona@users.noreply.github.com</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # The committer of the resulting commit</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Default: copies git_author_name</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    git_committer_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">GitHub Actions</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # The email of the committer of the resulting commit</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Default: copies git_author_email</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    git_committer_email</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">41898282+github-actions[bot]@users.noreply.github.com</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Whether to comment on PRs</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Default: &#39;true&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    pr_comment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;false&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # The name of the branch that hosts the previews</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Default: gh-pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    preview_branch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">custom-pages-branch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # The name of the workflow file that contains the comment workflow in the preview repo</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Default: preview.yml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    preview_workflow_file_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">custom_workflow.yml</span></span></code></pre></div>`,27),l=[n];function p(o,h,r,c,k,d){return s(),a("div",null,l)}const y=e(t,[["render",p]]);export{g as __pageData,y as default};
